from JetEngine import *

# Create a new JetCOW opened for read/write
cow = JetCOW("world.cow", False, True)

# New scene, and reference it in the world header
scene = cow.newScene()
cow.getHeader().setAttrInt("MainScene", scene.id)
print "New scene"

# Add a light at the origin
light = cow.newDict("DynamicPointLight")
light.setAttrFloat("Intensity", 1)
scene.attachChild(light)
light.unref()
print "Added light"

# Add skybox to the scene
skybox = cow.newDict("Skybox")
scene.attachChild(skybox)
skybox.unref()
print "Added skybox"

# Now a quad with some landscape
distance = -200
height = -30
size = 50
scale = 20
quad = cow.newDict("QuadGenerator")
quad.setAttrFloat("ax", -size)
quad.setAttrFloat("az", size)
quad.setAttrFloat("bx", -size)
quad.setAttrFloat("bz", -size)
quad.setAttrFloat("cx", size)
quad.setAttrFloat("cz", -size)
quad.setAttrFloat("dx", size)
quad.setAttrFloat("dz", size)
disp = cow.newDict("MidpointDisplacement")
disp.setAttrInt("Parent",quad.id)
disp.setAttrFloat("Scale", scale)
surf = cow.newSceneNode("Surface")
surf.setAttrFloat("ty", height)
surf.setAttrFloat("tz", distance)
surf.setAttrInt("Generator", disp.id)
scene.attachChild(surf)
surf.unref()
disp.unref()
quad.unref()
print "Added quad"

# Unreference scene, flush JetCOW to disk
scene.unref()
cow.flush()

